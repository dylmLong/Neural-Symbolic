# NSDS: A Neural-Symbolic Data System for Geospatial Reasoning

We propose NSDS (Neural-Symbolic Data System), a next-generation framework designed to address the limitations of current AI scaling paradigms. As amassing more data and compute becomes unsustainable, NSDS provides a new approach by efficiently fusing the powerful perceptual capabilities of neural networks with the formal, verifiable logic of symbolic systems.

This project introduces NSDS as a multi-agent framework that supports dynamic, recursive, and multi-stage reasoning across diverse data types and heterogeneous programming environments. It offers a natural solution for automating task decomposition, iterative refinement, and coordinated execution between the neural and symbolic components of the system.

## Framework

### Project Structure

```
Neural-Symbolic-master/
├── agent/
│   ├── decompositionAgent/  # Decomposition Agent: selects operators from UOP, builds execution plan, classifies intent
│   ├── coordinationAgent/   # Coordination Agent: feedback, error handling, rollback, retry
│   ├── codingAgent/         # Coding Agent: generates execution instructions (perception calls, SQL queries)
│   ├── executionAgent/      # Execution Agent: executes code/instructions generated by Coding Agent
│   └── shared/              # AgentState, ExecutionInstruction, common data structures
│
├── operators/               # Unified Operator Pool (UOP)
│   ├── perception/          # Perception operators (physical operators)
│   ├── execution/           # Execution operators (physical operators)
│   ├── coding/              # Coding operators (logical operators)
│   └── coordination/       # Coordination operators (logical operators)
│
├── common/
│   └── config_loader.py
│
├── data/
│   └── test1.jpg
│
├── duckdb/
│   └── demo.db
│
├── llm/
│   └── qwen_wrapper.py
│
├── models/
│   └── yolo/
│       └── yolov8_best.pt
│
├── scripts/
│   ├── sql/
│   │   ├── 01_create_geo_table.sql
│   │   └── 02_insert_geo_data.sql
│   └── init_db.py
│
├── .gitignore
├── config.yaml
├── README.md
└── requirements.txt
```

## Requirements

Based on our requirements.txt file:

- ultralytics==8.3.159
- langgraph==0.5.1
- langchain==0.3.26
- pyyaml==6.0.1
- pillow~=11.3.0
- langchain-core~=0.3.68
- duckdb==1.3.2

## Install dependencies

```bash
# Python version: 3.10
pip install -r requirements.txt
```

## Startup program

Execute the main function in `agent/decompositionAgent/DecompositionAgent.py`:

```bash
python -m agent.decompositionAgent.DecompositionAgent
```

## Architecture Design Principles

### 1. Interface Separation
- **Coding Agent**: Only responsible for generating code/instructions, not execution
- **Execution Agent**: Only responsible for executing code/instructions generated by Coding Agent, not code generation

### 2. Unified Operator Pool (UOP)
- All functionalities are encapsulated as operators, stored in the `operators/` directory
- Agents select and call operators from the operator pool
- Operators are categorized as physical operators (interacting with external systems) and logical operators (data processing and decision-making)

### 3. Execution Flow

```
┌──────────────┐
│Human Message │
└──────────────┘
        │
        ▼
┌────────────────────┐
│Decomposition Agent │  (Intent classification, routing)
│(Entry Point)       │
└────────────────────┘
        │
        ├─ chat ──────► ChatResponder (Execution Agent)
        │
        └─ reasoning ──►
                        │
                        ▼
                ┌──────────────────┐
                │Coding Agent      │  (Generate perception call instruction)
                │(Generate Code)  │
                └──────────────────┘
                        │
                        ▼
                ┌──────────────────┐
                │Execution Agent   │  (Execute perception instruction)
                │(Execute Code)    │
                └──────────────────┘
                        │
                        ▼
                ┌──────────────────┐
                │Coding Agent      │  (Generate SQL queries)
                │(Generate Code)   │
                └──────────────────┘
                        │
                        ▼
                ┌──────────────────┐
                │Execution Agent   │  (Execute SQL, loop)
                │(Execute Code)    │
                └──────────────────┘
                        │
                        ▼
                ┌──────────────────┐
                │Execution Agent   │  (Result filtering)
                │(Result Summary)  │
                └──────────────────┘
                        │
                        ▼
                ┌──────────────────┐
                │Result Summarizer │  (Natural language description)
                │(Standalone)      │
                └──────────────────┘
```

## Four Agent Responsibilities

### 1. Decomposition Agent
- **Location**: `agent/decompositionAgent/DecompositionAgent.py`
- **Responsibilities**:
  - Classify user intent (intent classification)
  - Determine execution flow direction based on intent (intent routing)
  - Select operators from operator pool and compose execution plan (LangGraph DAG)
  - Serve as system entry point

### 2. Coding Agent
- **Location**: `agent/codingAgent/CodingAgent.py`
- **Responsibilities**:
  - Generate perception call instructions (YOLO detection)
  - Generate SQL query code
  - **Interface Separation**: Only responsible for generating code/instructions, not execution

### 3. Execution Agent
- **Location**: `agent/executionAgent/ExecutionAgent.py`
- **Responsibilities**:
  - Execute perception instructions generated by Coding Agent
  - Execute SQL queries
  - SQL routing (select next SQL to execute)
  - Result filtering
  - Chat response
  - **Interface Separation**: Only responsible for execution, not code generation

### 4. Coordination Agent
- **Location**: `agent/coordinationAgent/CoordinationAgent.py`
- **Responsibilities**:
  - Centralized feedback signal reception
  - Fault point identification
  - Rollback or retry invocation
  - Automated exploration, backtracking, and optimization loops
  - **Note**: Architecture is ready, awaiting implementation of specific feedback handling logic

## Operator Pool (UOP - Unified Operator Pool)

All functionalities are encapsulated as operators, stored in the `operators/` directory:

### Physical Operators (Interacting with External Systems)
- `operators/perception/yolo_detector.py` - YOLO object detection
- `operators/execution/sql_executor.py` - SQL query execution

### Logical Operators (Data Processing and Decision-Making)
- `operators/coding/perception_code_generator.py` - Perception code generation
- `operators/coding/sql_generator.py` - SQL generation
- `operators/coordination/intent_classifier.py` - Intent classification
- `operators/coordination/sql_router.py` - SQL routing
- `operators/coordination/result_filter.py` - Result filtering
- `operators/coordination/result_summarizer.py` - Result summarization (converts structured results to natural language)
- `operators/coordination/chat_responder.py` - Chat response

## Mapping of Four Agents to Paper Concepts

1. **Decomposition Agent**: `agent/decompositionAgent`, responsible for selecting operators from operator pool, composing execution plan, classifying intent and routing.
2. **Coding Agent**: `agent/codingAgent`, responsible for generating execution instructions (perception calls, SQL queries).
3. **Execution Agent**: `agent/executionAgent`, responsible for executing code/instructions generated by Coding Agent.
4. **Coordination Agent**: `agent/coordinationAgent`, responsible for feedback, error handling, rollback, retry.

> Current stage focuses on four core agents, with analysis and optimization roles to be extended in the future.
